哈尔滨理工大学
计算机科学与技术学院

《DB-Java》
课程设计报告

题 目 ：水果销售管理系统设计与实现
班 级 ：软件 24- 班
专 业 ：软件工程
姓名
（学 号） ：姓名（学号）、姓名（学号）、
：姓名（学号）、姓名（学号）、
指导教师 ：张三
日期 ：2026 年 1 月 9 日

目录
一、需求分析（三号，宋体，粗体） 2
二、系统设计（三号，宋体，粗体） 2
（一）系统中的数据定义（四号，黑体，粗体） 2
（二）系统的概要设计 2
（三）系统的详细设计 2
（四）数据库设计 2
（五）系统的核心算法 2
三、系统编码及运行（三号，宋体，粗体） 3
（一）系统开发涉及的软件 3
（二）系统运行界面及结果 3
四、系统测试（三号，宋体，粗体） 3
五、总结 3
附录（源代码） 4
（注：这部分可以点击右键更新生成，重新设置字体为四号）

一、需求分析（三号，宋体，粗体）
正文用小四字体，行间距为 1.5 倍。
随着信息技术的飞速发展，传统的手工记账方式已无法满足现代水果店高效、精准的管理需求。手工记录不仅效率低下，而且容易出错，难以实时掌握库存动态和销售情况。
本系统旨在开发一套基于 Web 的水果销售管理系统，通过数字化手段实现对水果进销存的全流程管理。
主要功能包括：

1.  **基础信息管理**：对水果商品、供应商、客户、员工等基础数据进行增删改查。
2.  **进货管理**：记录水果入库信息，自动增加库存。
3.  **销售管理**：记录销售交易，自动扣减库存并计算总价。
4.  **统计分析**：提供销售报表，按水果种类、员工绩效等维度进行数据可视化展示。

二、系统设计（三号，宋体，粗体）
（一）系统中的数据定义（四号，黑体，粗体）
本系统共包含 6 个实体集，详细定义如下：

**1. 实体集：fruit (水果商品)**
用于存储水果的基本信息，是系统的核心数据。

- `id` (Long): 商品唯一标识，主键，自增。
- `name` (String): 水果名称，如“红富士苹果”。
- `price` (Double): 销售单价，单位：元。
- `stock` (Integer): 当前库存数量，进货增加，销售减少。
- `supplierId` (Long): 关联供应商 ID，外键。

**2. 实体集：customer (客户)**
用于存储购买水果的客户信息，便于进行客户关系管理。

- `id` (Long): 客户唯一标识，主键，自增。
- `name` (String): 客户姓名。
- `phone` (String): 联系电话。
- `address` (String): 联系地址。

**3. 实体集：employee (员工)**
用于存储店铺员工信息，用于销售记录的经手人关联。

- `id` (Long): 员工唯一标识，主键，自增。
- `name` (String): 员工姓名。
- `phone` (String): 联系电话。
- `position` (String): 职位，如“店长”、“销售员”。

**4. 实体集：supplier (供应商)**
用于存储水果供货商信息，用于入库记录的来源关联。

- `id` (Long): 供应商唯一标识，主键，自增。
- `name` (String): 供应商名称。
- `phone` (String): 联系电话。
- `address` (String): 供应商地址。

**5. 联系集：sales (销售记录)**
记录每一次销售交易的详细信息，关联水果、客户和员工。

- `id` (Long): 销售记录 ID，主键，自增。
- `fruitId` (Long): 销售的水果 ID。
- `customerId` (Long): 购买客户 ID。
- `employeeId` (Long): 经手员工 ID。
- `quantity` (Integer): 销售数量。
- `totalPrice` (Double): 本次交易总金额。
- `saleDate` (LocalDateTime): 销售时间，自动生成。

**6. 联系集：stock_in (入库记录)**
记录每一次进货交易的详细信息，关联水果和供应商。

- `id` (Long): 入库记录 ID，主键，自增。
- `fruitId` (Long): 入库的水果 ID。
- `supplierId` (Long): 供货商 ID。
- `quantity` (Integer): 入库数量。
- `stockInDate` (LocalDateTime): 入库时间，自动生成。

（二）系统的概要设计
系统采用 B/S (Browser/Server) 架构，前后端分离设计。

1.  **前端层**：使用 Vue.js 3 + Element Plus 构建单页应用 (SPA)，负责页面展示和用户交互。通过 Axios 发送异步请求与后端通信。
2.  **后端层**：使用 Spring Boot 框架，提供 RESTful API 接口。
    - Controller 层：接收前端请求，参数校验。
    - Service 层：处理业务逻辑（如库存检查、价格计算）。
    - Repository 层：使用 Spring Data JPA 与数据库交互。
3.  **数据层**：使用 MySQL 8.0 存储业务数据。

（三）系统的详细设计
本系统主要包含以下功能模块，各模块均实现了完整的 CRUD (增删改查) 操作：

     **1. 基础信息管理模块 (CRUD)**
     - **功能**: 对水果、客户、员工、供应商进行管理。
     - **流程**:
       - **Create (增)**: 前端填写表单 -> POST 请求 -> Service 保存 -> 返回新对象。
       - **Read (查)**: GET 请求 -> Repository `findAll()` -> 返回列表。
       - **Update (改)**: PUT 请求 -> Service 更新字段 -> Repository `save()`。
       - **Delete (删)**: DELETE 请求 -> Repository `deleteById()`。

     **2. 销售业务模块**
     - **功能**: 处理销售交易，自动扣减库存。
     - **流程**:
       1. 用户在前端选择水果、客户、员工，输入数量。
       2. 前端发送 POST 请求至 `/api/sales`。
       3. 后端 `SalesService` 接收请求。
       4. **库存检查**: 查询 `Fruit` 表，判断 `stock >= quantity`。
       5. **扣减库存**: 若充足，`fruit.setStock(fruit.getStock() - quantity)`。
       6. **计算总价**: `totalPrice = fruit.getPrice() * quantity`。
       7. **保存记录**: 保存 `Sales` 对象，更新 `Fruit` 对象。

     **3. 进货业务模块**
     - **功能**: 处理入库交易，自动增加库存。
     - **流程**:
       1. 用户选择水果、供应商，输入数量。
       2. 后端接收请求，更新 `Fruit` 表：`fruit.setStock(fruit.getStock() + quantity)`。
       3. 保存 `StockIn` 记录。

（四）数据库设计
必须有 ER 图\***\*\*\*\***
(此处应插入 ER 图，描述 Fruit, Customer, Employee, Supplier, Sales, StockIn 之间的关系)

（五）系统的核心算法
本系统的核心算法主要体现在业务逻辑的处理上，特别是涉及库存变动和金额计算的环节。主要包含以下三个核心算法：

**1. 销售业务处理算法**
该算法用于处理销售请求，确保库存充足并自动计算总金额。

- **输入**：销售商品 ID (`fruitId`)，销售数量 (`quantity`)。
- **输出**：销售记录对象 (`Sales`) 或 异常提示。
- **算法流程**：
  1. 根据 `fruitId` 查询商品信息 `fruit`。
  2. **库存检查**：判断 `fruit.stock >= quantity`。
     - 若 `false`，抛出“库存不足”异常，终止交易。
  3. **库存扣减**：更新库存 `newStock = fruit.stock - quantity`。
  4. **金额计算**：计算总价 `totalPrice = fruit.price * quantity`。
  5. **持久化**：
     - 更新 `fruit` 表中的库存字段。
     - 创建并保存 `sales` 记录（包含 `totalPrice` 和 `saleDate`）。
  6. 返回交易成功信息。

**2. 进货入库算法**
该算法用于处理进货请求，自动增加对应商品的库存。

- **输入**：入库商品 ID (`fruitId`)，入库数量 (`quantity`)。
- **输出**：入库记录对象 (`StockIn`)。
- **算法流程**：
  1. 根据 `fruitId` 查询商品信息 `fruit`。
  2. **库存增加**：计算新库存 `newStock = fruit.stock + quantity`。
  3. **持久化**：
     - 更新 `fruit` 表中的库存字段。
     - 创建并保存 `stock_in` 记录。
  4. 返回入库成功信息。

**3. 销售统计分析算法**
该算法用于生成销售报表，按商品维度统计销售总额。

- **输入**：无（或时间范围）。
- **输出**：统计结果列表（包含商品名称、总销量、总销售额）。
- **算法逻辑（SQL 实现）**：
  1. 关联 `sales` 表和 `fruit` 表。
  2. 按 `fruit_id` 进行分组 (`GROUP BY`)。
  3. 使用聚合函数 `SUM(quantity)` 计算总销量。
  4. 使用聚合函数 `SUM(total_price)` 计算总销售额。
  5. 按总销售额降序排序 (`ORDER BY ... DESC`)。

三、系统编码及运行（三号，宋体，粗体）
（一）系统开发涉及的软件 1. **开发工具**: Visual Studio Code (VS Code) 2. **后端环境**: JDK 17, Maven 3.8+ 3. **前端环境**: Node.js 16+, Vue CLI / Vite 4. **数据库**: MySQL 8.0 Community Server 5. **辅助工具**: Postman (接口测试), Navicat (数据库管理)

（二）系统运行界面及结果
本系统主要包含以下几个核心运行界面，各界面设计简洁、操作直观：

**图 1 系统登录界面**
系统入口页面，采用现代化极简设计。界面中央为登录卡片，包含“用户名”和“密码”输入框。支持输入校验功能，若未输入必填项会提示错误信息。背景采用深色调，突显登录区域，确保用户专注。

**图 2 系统仪表盘 (Dashboard) 界面**
登录后的主页，展示系统的核心运营数据。顶部卡片显示“今日销售额”、“总订单数”、“库存预警”等关键指标。中部包含快捷导航入口，方便快速跳转至销售或进货模块。

**图 3 水果商品管理界面**
商品信息维护的核心页面。主体为数据表格，展示水果的 ID、名称、价格、当前库存及供应商信息。

- **顶部工具栏**：提供按名称模糊搜索的功能。
- **操作列**：每行数据后包含“编辑”和“删除”按钮，点击“新增”按钮可弹出模态框录入新商品。

**图 4 销售业务处理界面**
用于日常收银操作。界面左侧为开单区域，支持下拉选择客户、员工和水果商品（自动显示实时库存和单价），输入数量后自动计算总价。右侧或下方实时显示最新的销售流水记录，方便核对。

**图 5 进货入库管理界面**
用于处理水果进货业务。操作员选择供应商和水果商品，输入入库数量。提交后，系统会自动更新该商品的库存数量，并在下方表格中生成一条入库记录。

**图 6 销售统计分析界面**
数据可视化分析页面。通过图表（如柱状图或饼图）展示各水果的销售占比和营收排名。表格区域详细列出了每种水果的累计销量和总销售额，并按销售额降序排列，帮助管理者识别热销商品。

四、系统测试（三号，宋体，粗体）

### 4.1 系统测试背景

#### 4.1.1 系统测试的意义和目的

系统测试的目的是通过系统化、全面性的测试方法，确保软件的各项功能、性能、安全性等方面达到预期标准，并验证软件的质量是否符合发布标准。其主要目的是：确认软件的质量符合预定标准，确保开发过程中没有遗漏任何重要功能；确保软件在各种环境中都能正常运行，包括不同操作系统、硬件环境、网络条件等；通过全面的测试，识别并修复潜在的错误、缺陷或漏洞，提高软件的稳定性和可靠性；优化软件的性能、响应速度和负载能力，确保能够满足用户的大规模使用需求；增强软件的安全性，防止数据泄露、恶意攻击等风险。

#### 4.1.2 系统测试的方法

系统测试是验证软件功能和性能是否符合需求的过程。为了确保软件质量，采用不同的测试方法可以帮助开发团队发现潜在的缺陷和问题。系统测试的方法有多种，通常根据测试目标、测试阶段以及测试类型来选择合适的测试方法。本系统主要采用黑盒测试法，针对功能模块进行输入输出验证。

### 4.2 系统测试用例与运行截图

#### 4.2.1 管理员登录功能测试

管理员登录模块是系统的安全入口，主要负责验证操作员的身份合法性。通过此模块，系统比对输入的用户名和密码，确保只有授权人员才能进入后台管理系统。
**图 13**
**图 14**

#### 4.2.2 基础信息管理测试 (水果/客户/员工)

基础信息管理模块主要负责维护系统运行所需的核心数据。管理员可以对水果商品、客户资料、员工信息进行增删改查操作，确保数据的实时性和准确性。
**图 15**
**图 16**

#### 4.2.3 进货入库业务测试

进货入库模块主要负责处理水果的采购入库流程。该模块的核心功能是选择供应商和商品，输入入库数量，系统自动增加库存并生成入库记录，确保账实相符。
**图 17**
**图 18**

#### 4.2.4 销售收银业务测试

销售收银模块是系统的核心业务功能。测试重点在于验证销售开单时，系统能否正确计算总金额、自动扣减对应商品的库存，并生成完整的销售流水记录。
**图 19**
**图 20**

#### 4.2.5 销售统计分析测试

统计分析模块用于展示系统的经营状况。测试主要验证系统能否根据历史销售数据，正确生成销售报表和图表，帮助管理者直观了解热销商品和营收情况。
**图 21**

### 4.3 测试中遇到的具体问题

| Bug                            | 解决方案                                                                                                    |
| :----------------------------- | :---------------------------------------------------------------------------------------------------------- |
| **JDBC 无法读取到数据库**      | 驱动版本不匹配（MySQL 8.0 需使用 `com.mysql.cj.jdbc.Driver`），更新 Maven 依赖并重装驱动适配。              |
| **身份验证错误，错误匹配信息** | 重写 Service 层的登录逻辑，确保密码比对算法（如 MD5 或 BCrypt）与数据库存储格式一致。                       |
| **后端获取的数据无法传到前端** | 检查 Controller 层返回的 JSON 格式，修正前端 Vue 组件中 `response.data` 的解析路径和参数类型。              |
| **输入中文在数据库中存储乱码** | 确保 JDBC 连接字符串添加 `useUnicode=true&characterEncoding=utf-8`，并将 MySQL 表字符集设为 `utf8mb4`。     |
| **库存扣减与销售记录无法同步** | 在 Service 层方法上添加 `@Transactional` 注解，确保扣减库存和保存记录在同一个事务中执行，发生异常自动回滚。 |

五、总结

本项目旨在开发一款水果销售管理系统，通过实现基础信息管理、进货入库、销售收银及统计分析等核心功能，解决传统水果店手工记账效率低、库存管理混乱的问题，提供一种全新的数字化经营体验。系统实现了从商品录入、进货增加库存、销售扣减库存到财务统计的全流程闭环管理。

### 5.1 系统功能与实现

系统功能模块包括但不限于以下几个方面：

- **基础信息管理**：管理员可以查看、修改、删除水果商品、客户、员工及供应商信息，确保基础数据的准确性。
- **进货入库管理**：操作员选择供应商和商品进行入库，系统自动核算并增加对应商品的库存数量。
- **销售收银管理**：实现销售开单功能，自动计算总金额并实时扣减库存，生成销售流水记录。
- **统计分析功能**：系统根据历史销售数据，生成可视化的销售报表，帮助管理者掌握经营状况。

开发过程中，使用了 Java (Spring Boot) 作为后端开发框架，MySQL 作为数据库存储，前端采用 Vue.js 3 + Element Plus 进行单页应用设计，整个项目在 Visual Studio Code 中进行开发。

### 5.2 技术与工具

- **技术栈**：Java (Spring Boot)、Vue.js、MySQL
- **开发环境**：Visual Studio Code、Maven、Node.js
- **数据库**：MySQL 8.0
- **版本控制**：Git

### 5.3 项目过程与挑战

在项目开发过程中，遇到了一些挑战和困难，包括：

- **前后端分离架构挑战**：初次尝试前后端分离开发，在处理跨域请求 (CORS) 和统一 JSON 数据格式交互时遇到阻碍。通过配置 Spring Boot 的全局跨域策略和封装统一的 Result 响应对象解决了该问题。
- **数据库事务管理**：在销售和进货业务中，涉及多张表的更新（如插入记录同时更新库存）。如何保证数据的一致性是难点，通过引入 Spring 的 `@Transactional` 注解，确保了业务操作的原子性。
- **复杂查询与统计**：随着业务逻辑的增加，简单的 CRUD 无法满足统计需求。通过学习 JPA 的 `@Query` 注解和原生 SQL 编写，实现了复杂的分组统计功能。
- **界面交互体验**：为了提供更好的用户体验，前端使用了 Element Plus 组件库，在表单验证和弹窗交互上进行了多次优化。

### 5.4 测试与质量保证

为了确保系统的稳定性和功能完整性，我们进行了一系列的测试，包括：

- **功能测试**：确保进销存核心流程能够闭环运行，库存扣减逻辑准确无误。
- **边界测试**：针对库存不足、输入负数等异常情况进行测试，确保系统有正确的错误提示。
- **兼容性测试**：验证系统在不同浏览器（Chrome, Edge）下的显示效果和功能表现。

### 5.5 项目收获与不足

**收获**：

- 深入理解了 B/S 架构的设计思想，熟练掌握了 Spring Boot + Vue 的全栈开发流程。
- 提升了数据库设计能力，特别是对实体关系（一对多、多对一）和外键约束的理解。
- 学会了如何使用 Git 进行代码版本管理，以及使用 Maven 进行依赖管理。

**不足**：

- **安全性略显不足**：目前系统仅有简单的登录验证，尚未引入 Spring Security 或 JWT 进行完善的权限控制（RBAC）。
- **功能细节待优化**：如支付功能目前仅为模拟，未对接真实的支付接口（如支付宝/微信支付）。
- **代码复用性**：部分前端组件的代码复用率不高，后续可以进一步封装通用组件。

### 5.6 未来展望

在本项目的开发过程中，不仅提升了全栈开发能力，还学会了如何从业务需求出发设计系统。尽管系统已经实现了水果销售管理的核心功能，但仍有许多地方可以进一步优化和拓展。未来，我希望在以下几个方面进一步提升：

- **引入权限安全框架**
  计划引入 Spring Security 框架，实现细粒度的权限控制，区分管理员、店长和普通员工的操作权限，提升系统的安全性。

- **数据可视化与大数据处理**
  随着运营数据的积累，计划引入 ECharts 等更强大的图表库，提供更丰富的经营分析报表。同时学习数据库分库分表技术，以应对未来可能的大数据量挑战。

- **移动端适配与云部署**
  目前系统主要适配 PC 端，未来希望利用响应式布局技术适配移动端设备，方便店主随时随地查看经营数据。同时，学习 Docker 容器化技术，将系统部署到云服务器，实现真正的在线访问。

### 5.7 总结

本项目通过构建一款水果销售管理系统，成功地实现了水果店进销存业务的数字化管理，解决了传统手工记账的痛点。在项目开发过程中，通过不断地需求分析、技术选型、编码实现和测试反馈，逐步完善了系统功能。通过本项目，不仅掌握了现代 Web 开发的主流技术栈，也锻炼了解决实际问题的能力，为今后的软件开发之路打下了坚实的基础。

附录（源代码）
(此处可附上关键代码片段，如 SalesController.java, SalesService.java 等)
