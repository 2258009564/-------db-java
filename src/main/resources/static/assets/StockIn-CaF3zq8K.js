import{s as f}from"./request-Mhtq58za.js";import{_ as T,r,o as $,b as V,e as t,f as a,g as n,q as z,j as d,k as _,x as G,m as p,p as k,l as v,F as N,y as R,A as H}from"./index-RLn-V9R3.js";const J={class:"stockin-view"},K={class:"table-header"},O={style:{color:"#f56c6c"}},Q={class:"dialog-footer"},W={__name:"StockIn",setup(X){const g=r(!1),I=r([]),b=r([]),y=r([]),c=r(!1),s=r({}),w=r(null),D=r([]),q=async()=>{g.value=!0;try{const[o,e,u]=await Promise.all([f.get("/stockin"),f.get("/fruits"),f.get("/suppliers")]);I.value=o||[],b.value=e,y.value=u,D.value=I.value}catch(o){console.error(o)}finally{g.value=!1}},U=o=>{const e=b.value.find(u=>u.id===o);return e?e.name:o},B=o=>{const e=y.value.find(u=>u.id===o);return e?e.name:o},F=o=>o?new Date(o).toLocaleString():"",S=()=>{s.value={},c.value=!0},A=async()=>{w.value&&await w.value.validate(async o=>{o&&(await f.post("/stockin",s.value),H.success("进货成功"),c.value=!1,q())})};return $(()=>{q()}),(o,e)=>{const u=n("el-button"),i=n("el-table-column"),E=n("el-table"),L=n("el-card"),x=n("el-option"),h=n("el-select"),m=n("el-form-item"),C=n("el-input-number"),M=n("el-form"),P=n("el-dialog"),j=z("loading");return d(),V("div",J,[t(L,{shadow:"never"},{default:a(()=>[_("div",K,[e[7]||(e[7]=_("h3",null,"进货记录",-1)),t(u,{type:"primary",icon:"Plus",onClick:S},{default:a(()=>[...e[6]||(e[6]=[p("新增进货",-1)])]),_:1})]),G((d(),k(E,{data:D.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(i,{prop:"id",label:"ID",width:"80"}),t(i,{label:"水果"},{default:a(l=>[p(v(U(l.row.fruitId)),1)]),_:1}),t(i,{prop:"quantity",label:"数量"}),t(i,{label:"成本"},{default:a(l=>[_("span",O,"¥"+v(l.row.cost),1)]),_:1}),t(i,{label:"供应商"},{default:a(l=>[p(v(B(l.row.supplierId)),1)]),_:1}),t(i,{label:"日期"},{default:a(l=>[p(v(F(l.row.stockInDate)),1)]),_:1})]),_:1},8,["data"])),[[j,g.value]])]),_:1}),t(P,{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=l=>c.value=l),title:"新增进货",width:"500px"},{footer:a(()=>[_("span",Q,[t(u,{onClick:e[4]||(e[4]=l=>c.value=!1)},{default:a(()=>[...e[8]||(e[8]=[p("取消",-1)])]),_:1}),t(u,{type:"primary",onClick:A},{default:a(()=>[...e[9]||(e[9]=[p("确定",-1)])]),_:1})])]),default:a(()=>[t(M,{ref_key:"formRef",ref:w,model:s.value,"label-width":"80px"},{default:a(()=>[t(m,{label:"水果",prop:"fruitId",rules:[{required:!0,message:"请选择水果",trigger:"change"}]},{default:a(()=>[t(h,{modelValue:s.value.fruitId,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.fruitId=l),placeholder:"请选择水果",style:{width:"100%"}},{default:a(()=>[(d(!0),V(N,null,R(b.value,l=>(d(),k(x,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"数量",prop:"quantity",rules:[{required:!0,message:"请输入数量",trigger:"blur"}]},{default:a(()=>[t(C,{modelValue:s.value.quantity,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.quantity=l),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"成本",prop:"cost",rules:[{required:!0,message:"请输入成本",trigger:"blur"}]},{default:a(()=>[t(C,{modelValue:s.value.cost,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.cost=l),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"供应商",prop:"supplierId",rules:[{required:!0,message:"请选择供应商",trigger:"change"}]},{default:a(()=>[t(h,{modelValue:s.value.supplierId,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.supplierId=l),placeholder:"请选择供应商",style:{width:"100%"}},{default:a(()=>[(d(!0),V(N,null,R(y.value,l=>(d(),k(x,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ee=T(W,[["__scopeId","data-v-acc44107"]]);export{ee as default};
