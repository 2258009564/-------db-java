import{s as m}from"./request-DyfAWvOy.js";import{_ as T,r,o as $,b as y,e as t,f as a,g as s,q as z,j as i,k as w,x as G,m as d,p as k,l as V,F as C,y as N,A as H}from"./index-D9bfYO5o.js";const J={class:"stockin-view"},K={class:"table-header"},O={class:"dialog-footer"},Q={__name:"StockIn",setup(W){const f=r(!1),I=r([]),_=r([]),v=r([]),p=r(!1),n=r({}),g=r(null),D=r([]),q=async()=>{f.value=!0;try{const[o,e,u]=await Promise.all([m.get("/stockin"),m.get("/fruits"),m.get("/suppliers")]);I.value=o||[],_.value=e,v.value=u,D.value=I.value}catch(o){console.error(o)}finally{f.value=!1}},R=o=>{const e=_.value.find(u=>u.id===o);return e?e.name:o},B=o=>{const e=v.value.find(u=>u.id===o);return e?e.name:o},F=o=>o?new Date(o).toLocaleString():"",S=()=>{n.value={},p.value=!0},U=async()=>{g.value&&await g.value.validate(async o=>{o&&(await m.post("/stockin",n.value),H.success("进货成功"),p.value=!1,q())})};return $(()=>{q()}),(o,e)=>{const u=s("el-button"),c=s("el-table-column"),A=s("el-table"),E=s("el-card"),x=s("el-option"),h=s("el-select"),b=s("el-form-item"),L=s("el-input-number"),M=s("el-form"),P=s("el-dialog"),j=z("loading");return i(),y("div",J,[t(E,{shadow:"never"},{default:a(()=>[w("div",K,[e[6]||(e[6]=w("h3",null,"进货记录",-1)),t(u,{type:"primary",icon:"Plus",onClick:S},{default:a(()=>[...e[5]||(e[5]=[d("新增进货",-1)])]),_:1})]),G((i(),k(A,{data:D.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(c,{prop:"id",label:"ID",width:"80"}),t(c,{label:"水果"},{default:a(l=>[d(V(R(l.row.fruitId)),1)]),_:1}),t(c,{prop:"quantity",label:"数量"}),t(c,{label:"供应商"},{default:a(l=>[d(V(B(l.row.supplierId)),1)]),_:1}),t(c,{label:"日期"},{default:a(l=>[d(V(F(l.row.stockInDate)),1)]),_:1})]),_:1},8,["data"])),[[j,f.value]])]),_:1}),t(P,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l),title:"新增进货",width:"500px"},{footer:a(()=>[w("span",O,[t(u,{onClick:e[3]||(e[3]=l=>p.value=!1)},{default:a(()=>[...e[7]||(e[7]=[d("取消",-1)])]),_:1}),t(u,{type:"primary",onClick:U},{default:a(()=>[...e[8]||(e[8]=[d("确定",-1)])]),_:1})])]),default:a(()=>[t(M,{ref_key:"formRef",ref:g,model:n.value,"label-width":"80px"},{default:a(()=>[t(b,{label:"水果",prop:"fruitId",rules:[{required:!0,message:"请选择水果",trigger:"change"}]},{default:a(()=>[t(h,{modelValue:n.value.fruitId,"onUpdate:modelValue":e[0]||(e[0]=l=>n.value.fruitId=l),placeholder:"请选择水果",style:{width:"100%"}},{default:a(()=>[(i(!0),y(C,null,N(_.value,l=>(i(),k(x,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"数量",prop:"quantity",rules:[{required:!0,message:"请输入数量",trigger:"blur"}]},{default:a(()=>[t(L,{modelValue:n.value.quantity,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value.quantity=l),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(b,{label:"供应商",prop:"supplierId",rules:[{required:!0,message:"请选择供应商",trigger:"change"}]},{default:a(()=>[t(h,{modelValue:n.value.supplierId,"onUpdate:modelValue":e[2]||(e[2]=l=>n.value.supplierId=l),placeholder:"请选择供应商",style:{width:"100%"}},{default:a(()=>[(i(!0),y(C,null,N(v.value,l=>(i(),k(x,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Z=T(Q,[["__scopeId","data-v-82618357"]]);export{Z as default};
