import{s as g}from"./request-Csjh3FQq.js";import{_ as W,r as i,c as h,w as X,b as v,e as r,f as a,g as s,q as Y,j as o,k as $,x as Z,y as c,m as b,F as B,z as E,l as C,p as ee,E as le,A as U}from"./index-D2kKzkIT.js";const te={class:"base-table"},ae={class:"table-header"},oe={key:0,style:{color:"#67C23A","font-weight":"bold"}},pe={key:2},re={class:"dialog-footer"},se={__name:"BaseTable",props:{type:{type:String,required:!0}},setup(S){const u=S,k=i(!1),V=i([]),d=i(""),m=i(!1),n=i({}),x=i(null),f=i(!1),D={fruits:{columns:[{prop:"id",label:"ID",width:80},{prop:"name",label:"名称"},{prop:"price",label:"单价",type:"price"},{prop:"unit",label:"单位"},{prop:"stock",label:"库存",type:"stock"}],fields:[{prop:"name",label:"名称"},{prop:"price",label:"单价",type:"number"},{prop:"unit",label:"单位"},{prop:"stock",label:"库存",type:"number"}]},employees:{columns:[{prop:"id",label:"ID",width:80},{prop:"name",label:"姓名"},{prop:"phone",label:"电话"},{prop:"position",label:"职位"}],fields:[{prop:"name",label:"姓名"},{prop:"phone",label:"电话"},{prop:"position",label:"职位"}]},customers:{columns:[{prop:"id",label:"ID",width:80},{prop:"name",label:"姓名"},{prop:"phone",label:"电话"},{prop:"membershipId",label:"会员号"}],fields:[{prop:"name",label:"姓名"},{prop:"phone",label:"电话"},{prop:"membershipId",label:"会员号"}]},suppliers:{columns:[{prop:"id",label:"ID",width:80},{prop:"name",label:"名称"},{prop:"phone",label:"电话"},{prop:"address",label:"地址"}],fields:[{prop:"name",label:"名称"},{prop:"phone",label:"电话"},{prop:"address",label:"地址"}]}},q=h(()=>{var t;return((t=D[u.type])==null?void 0:t.columns)||[]}),F=h(()=>{var t;return((t=D[u.type])==null?void 0:t.fields)||[]}),N=h(()=>f.value?"编辑":"新增"),T=h(()=>{if(!d.value)return V.value;const t=d.value.toLowerCase();return V.value.filter(l=>Object.values(l).some(w=>String(w).toLowerCase().includes(t)))}),y=async()=>{k.value=!0;try{V.value=await g.get(`/${u.type}`)}finally{k.value=!1}},z=async()=>{if(!d.value){y();return}},A=()=>{f.value=!1,n.value={},m.value=!0},L=t=>{f.value=!0,n.value={...t},m.value=!0},j=t=>{le.confirm("确认删除该记录吗?","提示",{type:"warning"}).then(async()=>{await g.delete(`/${u.type}/${t.id}`),U.success("删除成功"),y()})},M=async()=>{x.value&&await x.value.validate(async t=>{if(t)try{f.value?await g.post(`/${u.type}`,n.value):await g.post(`/${u.type}`,n.value),U.success("保存成功"),m.value=!1,y()}catch{}})};return X(()=>u.type,()=>{d.value="",y()},{immediate:!0}),(t,l)=>{const w=s("el-input"),_=s("el-button"),R=s("el-tag"),I=s("el-table-column"),O=s("el-table"),P=s("el-card"),Q=s("el-input-number"),G=s("el-form-item"),H=s("el-form"),J=s("el-dialog"),K=Y("loading");return o(),v("div",te,[r(P,{shadow:"never"},{default:a(()=>[$("div",ae,[r(w,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),placeholder:"搜索...","prefix-icon":"Search",style:{width:"300px"},clearable:"",onInput:z},null,8,["modelValue"]),r(_,{type:"primary",icon:"Plus",onClick:A},{default:a(()=>[...l[3]||(l[3]=[c("新增记录",-1)])]),_:1})]),Z((o(),b(O,{data:T.value,style:{width:"100%","margin-top":"20px"},stripe:""},{default:a(()=>[(o(!0),v(B,null,E(q.value,e=>(o(),b(I,{key:e.prop,prop:e.prop,label:e.label,width:e.width},{default:a(p=>[e.type==="price"?(o(),v("span",oe," ¥"+C(p.row[e.prop]),1)):e.type==="stock"?(o(),b(R,{key:1,type:p.row[e.prop]<10?"danger":"success"},{default:a(()=>[c(C(p.row[e.prop]),1)]),_:2},1032,["type"])):(o(),v("span",pe,C(p.row[e.prop]),1))]),_:2},1032,["prop","label","width"]))),128)),r(I,{label:"操作",width:"180",align:"right"},{default:a(e=>[r(_,{size:"small",onClick:p=>L(e.row)},{default:a(()=>[...l[4]||(l[4]=[c("编辑",-1)])]),_:1},8,["onClick"]),r(_,{size:"small",type:"danger",onClick:p=>j(e.row)},{default:a(()=>[...l[5]||(l[5]=[c("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,k.value]])]),_:1}),r(J,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=e=>m.value=e),title:N.value,width:"500px","destroy-on-close":""},{footer:a(()=>[$("span",re,[r(_,{onClick:l[1]||(l[1]=e=>m.value=!1)},{default:a(()=>[...l[6]||(l[6]=[c("取消",-1)])]),_:1}),r(_,{type:"primary",onClick:M},{default:a(()=>[...l[7]||(l[7]=[c("确定",-1)])]),_:1})])]),default:a(()=>[r(H,{ref_key:"formRef",ref:x,model:n.value,"label-width":"80px"},{default:a(()=>[(o(!0),v(B,null,E(F.value,e=>(o(),b(G,{key:e.prop,label:e.label,prop:e.prop,rules:[{required:!0,message:"请输入"+e.label,trigger:"blur"}]},{default:a(()=>[!e.type||e.type==="text"?(o(),b(w,{key:0,modelValue:n.value[e.prop],"onUpdate:modelValue":p=>n.value[e.prop]=p},null,8,["modelValue","onUpdate:modelValue"])):e.type==="number"?(o(),b(Q,{key:1,modelValue:n.value[e.prop],"onUpdate:modelValue":p=>n.value[e.prop]=p,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):ee("",!0)]),_:2},1032,["label","prop","rules"]))),128))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ie=W(se,[["__scopeId","data-v-e2f6f859"]]);export{ie as default};
